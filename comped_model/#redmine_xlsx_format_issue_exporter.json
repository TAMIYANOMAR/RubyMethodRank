{" XlsxExportHelper get_column_width":{"type":"method","name":"get_column_width","children":[],"call":["width > ","(send\n  (send\n    (lvar :value) :length) :+\n  (send\n    (send\n      (send\n        (lvar :value) :chars) :reject\n      (block-pass\n        (sym :ascii_only?))) :length)) * ","value length + ","value chars reject length ","value chars reject ","value chars ","value length ","(send\n  (send\n    (lvar :value) :length) :+\n  (send\n    (send\n      (send\n        (lvar :value) :chars) :reject\n      (block-pass\n        (sym :ascii_only?))) :length)) *  > "]}," XlsxExportHelper create_cell_format":{"type":"method","name":"create_cell_format","children":[],"call":["workbook add_format "]}," XlsxExportHelper create_header_format":{"type":"method","name":"create_header_format","children":[],"call":["workbook add_format "]}," XlsxExportHelper xlsx_value":{"type":"method","name":"xlsx_value","children":[],"call":["value to_s ","value gsub "," l "," l + ","other id ","value label_for ","value other_issue "," sprintf gsub "," sprintf "," format_date "," format_time ","value class name ","value class ","value other_issue  id ","value value other_issue _issue "]}," XlsxExportHelper xlsx_content":{"type":"method","name":"xlsx_content","children":[],"call":[" xlsx_value ","(send\n  (lvar :value) :collect) compact join ","(send\n  (lvar :value) :collect) compact ","value collect ","value is_a? ","column value "," xlsx_column value  ","(send\n  (lvar :column value ) :collect) compact join ","(send\n  (lvar :column value ) :collect) compact ","column value  collect ","column value  is_a? ","column column value  "]}," XlsxExportHelper export_to_xlsx":{"type":"method","name":"export_to_xlsx","children":[],"call":["stream string ","workbook close ","worksheet set_column ","columns_width [] ","columns each_with_index ","columns_width []= ","columns_width [] < "," get_column_width ","worksheet write ","item_index + "," xlsx_content ","items each_with_index ","columns_width << ","c caption to_s ","c caption "," create_cell_format "," create_header_format ","worksheet freeze_panes ","workbook add_worksheet ","WriteXLSX  new ","StringIO  new ","columns size times ","columns size "," write_item_rows "," write_header_row ","StringIO  new  string ","WriteXLSX  new  close ","workbook add_worksheet  set_column ","columns_ get_column_width  [] ","columns_ get_column_width  []= ","columns_ get_column_width  [] < "," get_column_ get_column_width  ","workbook add_worksheet  write ","columns_ get_column_width  << "," create_ create_cell_format  "," create_ create_header_format  ","workbook add_worksheet  freeze_panes ","workbook add_workbook add_worksheet  ","WriteXLSX  new  add_worksheet "]}," XlsxExportHelper query_to_xlsx":{"type":"method","name":"query_to_xlsx","children":[],"call":[" export_to_xlsx ","columns << ","options [] present? ","options [] ","column name ","query available_block_columns each ","query available_block_columns ","query inline_columns ","query available_inline_columns ","options [] == "," create_columns_list "," create_columns_list  << ","query available_block_ create_columns_list  each ","query available_block_ create_columns_list  ","query inline_ create_columns_list  ","query available_inline_ create_columns_list  "," create_ create_columns_list _list "]}," XlsxExportHelper create_hyperlink_format":{"type":"method","name":"create_hyperlink_format","children":[],"call":["workbook add_format "]}," XlsxExportHelper write_item":{"type":"method","name":"write_item","children":[],"call":["worksheet write ","row_index + "," url_for ","column name == ","column name ","worksheet write_string "," is_transformed_to_hyperlink? "]}," XlsxExportHelper write_item_rows":{"type":"method","name":"write_item_rows","children":[],"call":["columns_width []= ","columns_width [] < ","columns_width [] "," get_column_width "," write_item ","item id "," xlsx_content ","columns each_with_index ","items each_with_index "," create_cell_format "," create_hyperlink_format ","c name == ","c name ","columns_ get_column_width  []= ","columns_ get_column_width  [] < ","columns_ get_column_width  [] "," get_column_ get_column_width  "," create_ create_cell_format  "," create_ create_hyperlink_format  "]}," XlsxExportHelper write_header_row":{"type":"method","name":"write_header_row","children":[],"call":["columns_width << "," get_column_width ","worksheet write ","c caption to_s ","c caption ","columns each_with_index "," create_header_format "," create_ create_header_format  "]}," XlsxExportHelper create_columns_list":{"type":"method","name":"create_columns_list","children":[],"call":["columns << ","FilesQueryColumn  new ","options [] present? ","options [] ","column name ","query available_block_columns each ","query available_block_columns ","query inline_columns ","query available_inline_columns ","options [] == "]}," FilesQueryColumn value":{"type":"method","name":"value","children":[],"call":["value << ","attachment == ","issue attachments last ","issue attachments "," :  + ","attachment description ","attachment description? ","attachment filename ","issue attachments each ","issue attachments any? "]}," FilesQueryColumn caption":{"type":"method","name":"caption","children":[],"call":[" l "]}," XlsxExportHelper is_transformed_to_hyperlink?":{"type":"method","name":"is_transformed_to_hyperlink?","children":[],"call":["token =~ "]}," IssuesControllerPatch InstanceMethods index_with_xlsx":{"type":"method","name":"index_with_xlsx","children":[],"call":[" send_data "," query_to_xlsx "," params ","@query issue_count_by_group ","@query issues "," sort_clause ","@issue_pages offset ","Redmine Pagination Paginator  new "," params [] ","@query issue_count ","@query column_names= ","@query available_inline_columns map ","@query available_inline_columns "," params [] == ","Setting  issues_export_limit to_i ","Setting  issues_export_limit ","@query sort_criteria= "," sort_criteria to_a "," sort_criteria "," sort_update ","@query sortable_columns "," sort_init ","@query sort_criteria ","@query sort_criteria empty? "," retrieve_query "," index_without_xlsx "," params [] != ","Redmine Pagination Paginator  new  offset "]}," IssuesControllerPatch included":{"type":"method","name":"included","children":[],"call":[]}," RedmineXlsxFormatIssueExporter XlsxReportHelper create_period_format":{"type":"method","name":"create_period_format","children":[],"call":["workbook add_format "]}," RedmineXlsxFormatIssueExporter XlsxReportHelper write_item_row":{"type":"method","name":"write_item_row","children":[],"call":["columns_width []= ","columns_width [] < ","columns_width [] "," get_column_width "," write_item ","column_index < ","row each_with_index "," create_period_format "," create_cell_format "," create_hyperlink_format ","columns_ get_column_width  []= ","columns_ get_column_width  [] < ","columns_ get_column_width  [] "," get_column_ get_column_width  "," create_ create_period_format  "," create_ create_hyperlink_format  "]}," RedmineXlsxFormatIssueExporter XlsxReportHelper report_criteria_to_xlsx":{"type":"method","name":"report_criteria_to_xlsx","children":[],"call":[" report_criteria_to_xlsx ","level + ","criteria length > ","criteria length "," write_item_row ","row << ","sum > "," sum_hours "," select_hours ","period to_s ","periods each ","(str \"\") * ","criteria length - - ","criteria length - "," format_criteria_value to_s "," format_criteria_value ","available_criteria [] ","criteria [] ","hours_for_value empty? ","(send\n  (lvar :hours) :collect) uniq each ","(send\n  (lvar :hours) :collect) uniq ","h [] to_s ","h [] ","hours collect "," format_criteria_value_str "," write_item_(str \"\") *  ","(str \"\") *  << "," sum_hours  > ","  sum_hours _hours "," select_hours  empty? "]}," RedmineXlsxFormatIssueExporter XlsxReportHelper report_to_xlsx":{"type":"method","name":"report_to_xlsx","children":[],"call":["stream string ","workbook close ","worksheet set_column ","columns_width [] ","headers size times ","headers size "," write_item_row ","row << ","sum > "," sum_hours "," select_hours ","period to_s ","report columns ","report hours ","report periods each ","report periods ","(lvar :str_total) + ","(str \"\") * ","report criteria size - ","report criteria size ","report criteria "," l "," report_criteria_to_xlsx ","report available_criteria "," write_header_row ","headers << ","worksheet freeze_panes ","headers count ","report available_criteria [] [] ","report available_criteria [] ","report criteria collect ","workbook add_worksheet ","WriteXLSX  new ","StringIO  new "," l_or_humanize ","StringIO  new  string ","WriteXLSX  new  close ","workbook add_worksheet  set_column "," write_item_(lvar :str_total) +  ","(lvar :str_total) +  << "," sum_hours  > ","  sum_hours _hours ","(lvar : l ) + "," write_header_(lvar :str_total) +  ","workbook add_worksheet  freeze_panes ","workbook add_workbook add_worksheet  ","WriteXLSX  new  add_worksheet "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper create_hyperlink_format":{"type":"method","name":"create_hyperlink_format","children":[],"call":["workbook add_format "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper create_cell_format":{"type":"method","name":"create_cell_format","children":[],"call":["workbook add_format "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper create_header_format":{"type":"method","name":"create_header_format","children":[],"call":["workbook add_format "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper get_column_width":{"type":"method","name":"get_column_width","children":[],"call":["width > ","(send\n  (send\n    (lvar :value_str) :length) :+\n  (send\n    (send\n      (send\n        (lvar :value_str) :chars) :reject\n      (block-pass\n        (sym :ascii_only?))) :length)) * ","value_str length + ","value_str chars reject length ","value_str chars reject ","value_str chars ","value_str length ","value to_s ","(send\n  (send\n    (lvar :value_str) :length) :+\n  (send\n    (send\n      (send\n        (lvar :value_str) :chars) :reject\n      (block-pass\n        (sym :ascii_only?))) :length)) *  > ","(send\n  (send\n    (lvar :value to_s ) :length) :+\n  (send\n    (send\n      (send\n        (lvar :value to_s ) :chars) :reject\n      (block-pass\n        (sym :ascii_only?))) :length)) * ","value to_s  length + ","value to_s  chars reject length ","value to_s  chars reject ","value to_s  chars ","value to_s  length "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper write_item":{"type":"method","name":"write_item","children":[],"call":["worksheet write ","row_index + ","worksheet write_string "," is_transformed_to_hyperlink? "," url_for "," crlf_to_lf "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper is_transformed_to_hyperlink?":{"type":"method","name":"is_transformed_to_hyperlink?","children":[],"call":["token =~ "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper xlsx_content":{"type":"method","name":"xlsx_content","children":[],"call":[" csv_content "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper write_item_rows":{"type":"method","name":"write_item_rows","children":[],"call":["columns_width []= ","columns_width [] < ","columns_width [] "," get_column_width "," write_item ","item id ","c name == ","c name "," xlsx_content ","columns each_with_index ","items each_with_index "," create_cell_format "," create_hyperlink_format ","columns_ get_column_width  []= ","columns_ get_column_width  [] < ","columns_ get_column_width  [] "," get_column_ get_column_width  "," create_ create_cell_format  "," create_ create_hyperlink_format  "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper write_header_row":{"type":"method","name":"write_header_row","children":[],"call":["columns_width << "," get_column_width ","worksheet write ","c caption to_s ","c caption ","c class name == ","c class name ","c class ","columns each_with_index "," create_header_format "," create_ create_header_format  "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper export_to_xlsx":{"type":"method","name":"export_to_xlsx","children":[],"call":["stream string ","workbook close ","worksheet set_column ","columns_width [] ","columns size times ","columns size "," write_item_rows "," write_header_row ","worksheet freeze_panes ","workbook add_worksheet ","WriteXLSX  new ","StringIO  new ","StringIO  new  string ","WriteXLSX  new  close ","workbook add_worksheet  set_column ","workbook add_worksheet  freeze_panes ","workbook add_workbook add_worksheet  ","WriteXLSX  new  add_worksheet "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper create_columns_list":{"type":"method","name":"create_columns_list","children":[],"call":["columns << ","FilesQueryColumn  new ","options [] present? ","options [] ","column name ","query available_block_columns each ","query available_block_columns ","query inline_columns ","query available_inline_columns ","options [] == ","options [] include? ","query inline_columns  << ","query available_inline_columns  << ","query available_block_query inline_columns  each ","query available_block_query available_inline_columns  each ","query available_block_query inline_columns  ","query available_block_query available_inline_columns  ","query inline_query inline_columns  ","query inline_query available_inline_columns  ","query available_inline_query inline_columns  ","query available_inline_query available_inline_columns  "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper query_to_xlsx":{"type":"method","name":"query_to_xlsx","children":[],"call":[" export_to_xlsx "," create_columns_list ","stream string ","workbook close ","worksheet set_column ","columns_width [] ","columns size times ","columns size "," write_item_rows "," write_header_row ","worksheet freeze_panes ","workbook add_worksheet ","WriteXLSX  new ","StringIO  new ","query columns "," create_ create_columns_list _list "," create_query columns _list ","StringIO  new  string ","WriteXLSX  new  close ","workbook add_worksheet  set_column "," create_columns_list _width [] ","query columns _width [] "," create_columns_list  size times ","query columns  size times "," create_columns_list  size ","query columns  size ","workbook add_worksheet  freeze_panes ","workbook add_workbook add_worksheet  ","WriteXLSX  new  add_worksheet ","query  create_columns_list  ","query query columns  "]}," RedmineXlsxFormatIssueExporter ViewLayoutsBaseBodyBootomHook view_layouts_base_body_bottom":{"type":"method","name":"view_layouts_base_body_bottom","children":[],"call":["context [] send ","(pair\n  (sym :locals)\n  (lvar :context)) merge ","context [] ","call_from == ","context [] action_name ","context [] controller_name ","context [] status == ","context [] status "]}," RedmineXlsxFormatIssueExporter TimelogControllerPatch report":{"type":"method","name":"report","children":[],"call":[" send_data "," report_to_xlsx "," raise "," params [] != "," params [] "," params "]}," RedmineXlsxFormatIssueExporter TimelogControllerPatch index":{"type":"method","name":"index","children":[],"call":[" send_data "," query_to_xlsx "," params "," time_entry_scope preload preload to_a "," time_entry_scope preload preload "," time_entry_scope preload "," time_entry_scope "," raise "," params [] != "," params [] "," time_entry_scope to_a "]}," RedmineXlsxFormatIssueExporter IssuesControllerPatch index":{"type":"method","name":"index","children":[],"call":[" send_data "," query_to_xlsx "," params ","@query issues ","Setting  issues_export_limit to_i ","Setting  issues_export_limit ","@issues nil? "," raise "," params [] != "," params [] "," session [] []= "," session [] "," session "," session [] present? "," session [] [] "," add_params_from_settings "," params [] == ","@query issues  nil? "]}," RedmineXlsxFormatIssueExporter FilesQueryColumn value_object":{"type":"method","name":"value_object","children":[],"call":["(send\n  (send\n    (lvar :issue) :attachments) :map) join ","a filename ","issue attachments map ","issue attachments "]}," RedmineXlsxFormatIssueExporter FilesQueryColumn value":{"type":"method","name":"value","children":[],"call":["(send\n  (send\n    (lvar :issue) :attachments) :map) join ","a filename ","issue attachments map ","issue attachments "]}," RedmineXlsxFormatIssueExporter FilesQueryColumn caption":{"type":"method","name":"caption","children":[],"call":[" l "]}," RedmineXlsxFormatIssueExporter XlsxUsersHelper get_cell_value":{"type":"method","name":"get_cell_value","children":[],"call":[" format_object ","user send "," l ","User LABEL_BY_STATUS  [] ","user status ","column == "]}," RedmineXlsxFormatIssueExporter XlsxUsersHelper users_to_xlsx":{"type":"method","name":"users_to_xlsx","children":[],"call":["stream string ","workbook close ","worksheet set_column ","columns_width [] ","columns size times ","columns size ","columns_width []= ","columns_width [] < "," get_column_width "," write_item "," get_cell_value ","columns each_with_index ","users each_with_index "," create_cell_format "," create_hyperlink_format "," write_header_row "," l ","field_ + ","columns map ","worksheet freeze_panes ","workbook add_worksheet ","WriteXLSX  new ","StringIO  new ","user custom_value_for ","user_custom_fields [] ","column_index - ","columns length "," xlsx_content_users ","columns include? ","(send\n  (lvar :columns) :+\n  (send\n    (lvar :user_custom_fields) :pluck\n    (sym :name))) each_with_index ","columns + ","user_custom_fields pluck ","users preload ","(send\n  (lvar :columns) :map) + ","UserCustomField  sorted ","StringIO  new  string ","WriteXLSX  new  close ","workbook add_worksheet  set_column ","columns_ get_column_width  [] ","columns_ get_column_width  []= ","columns_ get_column_width  [] < "," get_column_ get_column_width  "," get_cell_ get_cell_value  "," get_cell_user custom_value_for  "," get_cell_ xlsx_content_users  ","users preload  each_with_index "," create_ create_cell_format  "," create_ create_hyperlink_format  ","workbook add_worksheet  freeze_panes ","workbook add_workbook add_worksheet  ","WriteXLSX  new  add_worksheet ","user custom_ get_cell_value _for ","user custom_user custom_value_for _for ","user custom_ xlsx_content_users _for ","UserCustomField  sorted  [] "," xlsx_content_users preload  ","(send\n  (lvar :columns) :+\n  (send\n    (lvar :UserCustomField  sorted ) :pluck\n    (sym :name))) each_with_index ","UserCustomField  sorted  pluck ","users preload  preload "]}," RedmineXlsxFormatIssueExporter XlsxReportHelper format_criteria_value_str":{"type":"method","name":"format_criteria_value_str","children":[],"call":[" format_criteria_value to_s "," format_criteria_value "," method parameters include? "," method parameters "," method "]}," RedmineXlsxFormatIssueExporter XlsxExportHelper crlf_to_lf":{"type":"method","name":"crlf_to_lf","children":[],"call":["value gsub ","value is_a? "]}," RedmineXlsxFormatIssueExporter UsersControllerPatch index":{"type":"method","name":"index","children":[],"call":[" send_data "," users_to_xlsx ","scope order "," sort_clause ","scope in_group "," params [] "," params "," params [] present? ","scope like ","User  logged status preload ","User  logged status ","User  logged "," raise "," params [] != "," query_to_xlsx ","@query results_scope to_a ","@query results_scope ","Redmine VERSION BRANCH  == ","Redmine VERSION MAJOR  <= "," send_ query_to_xlsx  "," send_ users_to_xlsx  ","scope in_group  order ","scope like  order ","User  logged status preload  order ","scope in_group  in_group ","scope like  in_group ","User  logged status preload  in_group ","scope in_group  like ","scope like  like ","User  logged status preload  like ","@query results_scope in_group  to_a ","@query results_scope like  to_a ","@query results_User  logged status preload  to_a ","@query results_scope in_group  ","@query results_scope like  ","@query results_User  logged status preload  "]}," RedmineXlsxFormatIssueExporter OtherFormatsBuilder link_to":{"type":"method","name":"link_to","children":[],"call":[" link_to_with_query_parameters "," respond_to? "]}," RedmineXlsxFormatIssueExporter ViewLayoutsBaseBodyBottomHook view_layouts_base_body_bottom":{"type":"method","name":"view_layouts_base_body_bottom","children":[],"call":["context [] send ","(pair\n  (sym :locals)\n  (lvar :context)) merge ","context [] ","call_from == ","context [] action_name ","context [] controller_name ","context [] status == ","context [] status ","Redmine VERSION BRANCH  == ","Redmine VERSION MAJOR  <= "]}," RedmineXlsxFormatIssueExporter ProjectsControllerPatch index":{"type":"method","name":"index","children":[],"call":[" send_data "," query_to_xlsx "," params "," project_scope "," raise "," params [] != "," params [] "," project_scope to_a "]}," RedmineXlsxFormatIssueExporter IssuesControllerPatch add_params_from_settings":{"type":"method","name":"add_params_from_settings","children":[],"call":["c == "," params [] delete_if "," params [] "," params "," params [] nil? "," params [] << "," params [] include? ","name to_sym "," params [] == "]}," RedmineXlsxFormatIssueExporter XlsxUsersHelper xlsx_content_users":{"type":"method","name":"xlsx_content_users","children":[],"call":[" format_object ","user send "," l ","user twofa_scheme ","user twofa_active? ","User LABEL_BY_STATUS  [] ","user status "]}}